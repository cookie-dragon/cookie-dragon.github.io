<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Delphi字符串加密解密算法</title>
      <link href="/2016/06/12/Delphi%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%8A%A0%E5%AF%86%E8%A7%A3%E5%AF%86%E7%AE%97%E6%B3%95/"/>
      <url>/2016/06/12/Delphi%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%8A%A0%E5%AF%86%E8%A7%A3%E5%AF%86%E7%AE%97%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<p>纯代码</p><a id="more"></a><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line">unit Unit1;</span><br><span class="line"></span><br><span class="line">interface</span><br><span class="line"></span><br><span class="line">uses</span><br><span class="line">  System.SysUtils;</span><br><span class="line"></span><br><span class="line">const</span><br><span class="line">  DefaultKey = &apos;delphi&apos;;</span><br><span class="line"></span><br><span class="line">//==============================================================================</span><br><span class="line">// 通过密钥加密解密</span><br><span class="line">// 对字符串加密(Source:源 Key:密匙)</span><br><span class="line">//==============================================================================</span><br><span class="line"></span><br><span class="line">function EncryptString(Source: string; Key: string = DefaultKey): string;</span><br><span class="line"></span><br><span class="line">function UnEncryptString(Source: string; Key: string = DefaultKey): string;</span><br><span class="line"></span><br><span class="line">implementation</span><br><span class="line"></span><br><span class="line">function EncryptString(Source: string; Key: string = DefaultKey): string;</span><br><span class="line">var</span><br><span class="line">  KeyLen: integer;</span><br><span class="line">  KeyPos: integer;</span><br><span class="line">  Offset: integer;</span><br><span class="line">  Dest: string;</span><br><span class="line">  SrcPos: integer;</span><br><span class="line">  SrcAsc: integer;</span><br><span class="line">  Range: integer;</span><br><span class="line">begin</span><br><span class="line">  KeyLen := Length(Key);</span><br><span class="line">  if KeyLen = 0 then</span><br><span class="line">    Key := DefaultKey;</span><br><span class="line">  KeyPos := 0;</span><br><span class="line">  Range := 256;</span><br><span class="line">  randomize;</span><br><span class="line">  Offset := random(Range);</span><br><span class="line">  Dest := format(&apos;%1.2x&apos;, [Offset]);</span><br><span class="line">  for SrcPos := 1 to Length(Source) do</span><br><span class="line">  begin</span><br><span class="line">    SrcAsc := (Ord(Source[SrcPos]) + Offset) mod 255;</span><br><span class="line">    if KeyPos &lt; KeyLen then</span><br><span class="line">      KeyPos := KeyPos + 1</span><br><span class="line">    else</span><br><span class="line">      KeyPos := 1;</span><br><span class="line">    SrcAsc := SrcAsc xor Ord(Key[KeyPos]);</span><br><span class="line">    Dest := Dest + format(&apos;%1.2x&apos;, [SrcAsc]);</span><br><span class="line">    Offset := SrcAsc;</span><br><span class="line">  end;</span><br><span class="line">  result := Dest;</span><br><span class="line">end;</span><br><span class="line"></span><br><span class="line">function UnEncryptString(Source: string; Key: string = DefaultKey): string;</span><br><span class="line">var</span><br><span class="line">  KeyLen: integer;</span><br><span class="line">  KeyPos: integer;</span><br><span class="line">  Offset: integer;</span><br><span class="line">  Dest: string;</span><br><span class="line">  SrcPos: integer;</span><br><span class="line">  SrcAsc: integer;</span><br><span class="line">  TmpSrcAsc: integer;</span><br><span class="line">begin</span><br><span class="line">  KeyLen := Length(Key);</span><br><span class="line">  if KeyLen = 0 then</span><br><span class="line">    Key := DefaultKey;</span><br><span class="line">  KeyPos := 0;</span><br><span class="line">  Offset := strtoint(&apos;$&apos; + copy(Source, 1, 2));</span><br><span class="line">  SrcPos := 3;</span><br><span class="line">  repeat</span><br><span class="line">    SrcAsc := strtoint(&apos;$&apos; + copy(Source, SrcPos, 2));</span><br><span class="line">    if KeyPos &lt; KeyLen then</span><br><span class="line">      KeyPos := KeyPos + 1</span><br><span class="line">    else</span><br><span class="line">      KeyPos := 1;</span><br><span class="line">    TmpSrcAsc := SrcAsc xor Ord(Key[KeyPos]);</span><br><span class="line">    if TmpSrcAsc &lt;= Offset then</span><br><span class="line">      TmpSrcAsc := 255 + TmpSrcAsc - Offset</span><br><span class="line">    else</span><br><span class="line">      TmpSrcAsc := TmpSrcAsc - Offset;</span><br><span class="line">    Dest := Dest + chr(TmpSrcAsc);</span><br><span class="line">    Offset := SrcAsc;</span><br><span class="line">    SrcPos := SrcPos + 2;</span><br><span class="line">  until SrcPos &gt;= Length(Source);</span><br><span class="line">  result := Dest;</span><br><span class="line">end;</span><br><span class="line"></span><br><span class="line">end.</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Windows </category>
          
          <category> Delphi </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 加密解密 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>搭建Windows NTP服务器</title>
      <link href="/2016/05/31/%E6%90%AD%E5%BB%BAWindows-NTP%E6%9C%8D%E5%8A%A1%E5%99%A8/"/>
      <url>/2016/05/31/%E6%90%AD%E5%BB%BAWindows-NTP%E6%9C%8D%E5%8A%A1%E5%99%A8/</url>
      
        <content type="html"><![CDATA[<p>【测试环境】Windows 7 旗舰版 With Sp1</p><a id="more"></a><h2 id="STEP1：组策略："><a href="#STEP1：组策略：" class="headerlink" title="STEP1：组策略："></a>STEP1：组策略：</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">计算机配置管理模板-Windows时间服务-时间提供程序-启用Windows NTP服务器（未配置-&gt;已启用）</span><br></pre></td></tr></table></figure><h2 id="STEP2：注册表："><a href="#STEP2：注册表：" class="headerlink" title="STEP2：注册表："></a>STEP2：注册表：</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\W32Time\Config\AnnounceFlags（Hex a Dec 10-&gt;Hex 5 Dec 5）</span><br></pre></td></tr></table></figure><h2 id="STEP3：CMD："><a href="#STEP3：CMD：" class="headerlink" title="STEP3：CMD："></a>STEP3：CMD：</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">net stop w32time</span><br><span class="line">net start w32time</span><br></pre></td></tr></table></figure><h2 id="STEP4：服务："><a href="#STEP4：服务：" class="headerlink" title="STEP4：服务："></a>STEP4：服务：</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Windows Time（手动-&gt;自动（延迟启动））</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Windows </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ntp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Delphi生成EXE自动以管理员身份运行</title>
      <link href="/2016/05/31/Delphi%E7%94%9F%E6%88%90EXE%E8%87%AA%E5%8A%A8%E4%BB%A5%E7%AE%A1%E7%90%86%E5%91%98%E8%BA%AB%E4%BB%BD%E8%BF%90%E8%A1%8C/"/>
      <url>/2016/05/31/Delphi%E7%94%9F%E6%88%90EXE%E8%87%AA%E5%8A%A8%E4%BB%A5%E7%AE%A1%E7%90%86%E5%91%98%E8%BA%AB%E4%BB%BD%E8%BF%90%E8%A1%8C/</url>
      
        <content type="html"><![CDATA[<p>【测试环境】Windows 7 旗舰版 With Sp1，RAD 10 Seattle</p><a id="more"></a><h2 id="STEP1、文本文件：UAC-manifest"><a href="#STEP1、文本文件：UAC-manifest" class="headerlink" title="STEP1、文本文件：UAC.manifest"></a>STEP1、文本文件：UAC.manifest</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;</span><br><span class="line">&lt;assembly xmlns=&quot;urn:schemas-microsoft-com:asm.v1&quot; manifestVersion=&quot;1.0&quot;&gt;</span><br><span class="line">&lt;trustInfo xmlns=&quot;urn:schemas-microsoft-com:asm.v3&quot;&gt;</span><br><span class="line">&lt;security&gt;</span><br><span class="line">&lt;requestedPrivileges&gt;</span><br><span class="line">&lt;requestedExecutionLevel level=&quot;requireAdministrator&quot; uiAccess=&quot;false&quot;&gt;</span><br><span class="line">&lt;/requestedExecutionLevel&gt;</span><br><span class="line">&lt;/requestedPrivileges&gt;</span><br><span class="line">&lt;/security&gt;</span><br><span class="line">&lt;/trustInfo&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">&lt;dependentAssembly&gt;</span><br><span class="line">&lt;assemblyIdentity type=&quot;win32&quot;</span><br><span class="line">name=&quot;Microsoft.Windows.Common-Controls&quot;</span><br><span class="line">version=&quot;6.0.0.0&quot;</span><br><span class="line">processorArchitecture=&quot;x86&quot;</span><br><span class="line">publicKeyToken=&quot;6595b64144ccf1df&quot;</span><br><span class="line">language=&quot;*&quot;&gt;</span><br><span class="line">&lt;/assemblyIdentity&gt;</span><br><span class="line">&lt;/dependentAssembly&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line">&lt;/assembly&gt;</span><br></pre></td></tr></table></figure><h2 id="STEP2、文本文件：UAC-rc"><a href="#STEP2、文本文件：UAC-rc" class="headerlink" title="STEP2、文本文件：UAC.rc"></a>STEP2、文本文件：UAC.rc</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1 24 UAC.manifest</span><br></pre></td></tr></table></figure><h2 id="STEP3、拷贝上述两个文件到RAD10目录下-bin（如Embarcadero-Studio-17-0-bin）"><a href="#STEP3、拷贝上述两个文件到RAD10目录下-bin（如Embarcadero-Studio-17-0-bin）" class="headerlink" title="STEP3、拷贝上述两个文件到RAD10目录下/bin（如Embarcadero\Studio\17.0\bin）"></a>STEP3、拷贝上述两个文件到RAD10目录下/bin（如Embarcadero\Studio\17.0\bin）</h2><h2 id="STEP4、用brcc32编译这个-rc文件为-res文件"><a href="#STEP4、用brcc32编译这个-rc文件为-res文件" class="headerlink" title="STEP4、用brcc32编译这个.rc文件为.res文件"></a>STEP4、用brcc32编译这个.rc文件为.res文件</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brcc32 uac.rc -fouac.res</span><br></pre></td></tr></table></figure><h2 id="STEP5、在工程文件-dpr中-R-res-后面加入-R-uac-res"><a href="#STEP5、在工程文件-dpr中-R-res-后面加入-R-uac-res" class="headerlink" title="STEP5、在工程文件.dpr中{$R *.res}后面加入{$R uac.res}"></a>STEP5、在工程文件.dpr中{$R *.res}后面加入{$R uac.res}</h2><h2 id="STEP6、打开工程属性，Application-gt-Manifest-File，改成Custom，在下方选择UAC-manifest文件，重新编译工程。"><a href="#STEP6、打开工程属性，Application-gt-Manifest-File，改成Custom，在下方选择UAC-manifest文件，重新编译工程。" class="headerlink" title="STEP6、打开工程属性，Application-&gt;Manifest File，改成Custom，在下方选择UAC.manifest文件，重新编译工程。"></a>STEP6、打开工程属性，Application-&gt;Manifest File，改成Custom，在下方选择UAC.manifest文件，重新编译工程。</h2>]]></content>
      
      
      <categories>
          
          <category> Windows </category>
          
          <category> Delphi </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 以管理员身份运行 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/2013/07/13/hello-world/"/>
      <url>/2013/07/13/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p><a id="more"></a><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="noopener">Deployment</a></p>]]></content>
      
      
      <categories>
          
          <category> 测试 </category>
          
          <category> 测试分类 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 测试标签 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
